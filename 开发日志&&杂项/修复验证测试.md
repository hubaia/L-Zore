# CardManager åˆå§‹åŒ–é¡ºåºä¿®å¤éªŒè¯

## ğŸ› é—®é¢˜æè¿°
```
CardManager.ts:66 Uncaught TypeError: Cannot read properties of undefined (reading 'children')
```

## ğŸ” åŸå› åˆ†æ
åˆå§‹åŒ–é¡ºåºé”™è¯¯ï¼š
1. `initializeManagers()` è°ƒç”¨äº† `setupManagerDependencies()`
2. `setupManagerDependencies()` ä¸­è°ƒç”¨äº† `cardManager.setHandGroups(this.playerHand, this.opponentHand)`
3. ä½†æ­¤æ—¶ `this.playerHand` å’Œ `this.opponentHand` è¿˜æœªåˆ›å»º
4. åç»­ `createPlayerHandArea()` å’Œ `createOpponentHandArea()` æ‰åˆ›å»ºäº†è¿™äº›å¯¹è±¡
5. å½“ `dealInitialCards()` è°ƒç”¨ `drawCard()` æ—¶ï¼ŒCardManager ä¸­çš„ hand groups å¼•ç”¨ä¸º undefined

## âœ… ä¿®å¤æ–¹æ¡ˆ

### 1. è°ƒæ•´åˆå§‹åŒ–é¡ºåº
```typescript
// ä¿®å¤å‰ï¼š
initializeManagers() {
    // ... åˆå§‹åŒ–å„ç§ç®¡ç†å™¨
    setupManagerDependencies(); // åœ¨ hand groups åˆ›å»ºå‰è°ƒç”¨
}

// ä¿®å¤åï¼š
initializeManagers() {
    // ... åˆå§‹åŒ–å„ç§ç®¡ç†å™¨
    // ç§»é™¤æ­¤å¤„çš„ setupManagerDependencies() è°ƒç”¨
}

// åœ¨ create() æ–¹æ³•ä¸­ï¼š
createPlayerHandArea();
createOpponentHandArea();
setupManagerDependencies(); // åœ¨ hand groups åˆ›å»ºåè°ƒç”¨
```

### 2. æ·»åŠ é˜²æŠ¤æ€§æ£€æŸ¥
ä¸º CardManager çš„å…³é”®æ–¹æ³•æ·»åŠ  null æ£€æŸ¥ï¼š

```typescript
dealInitialCards(): void {
    if (!this.playerHand || !this.opponentHand) {
        console.error('âŒ CardManager: hand groupsæœªåˆå§‹åŒ–ï¼Œæ— æ³•å‘æ”¾åˆå§‹æ‰‹ç‰Œ');
        this.showMessage('å¡ç‰Œç³»ç»Ÿæœªå°±ç»ªï¼Œæ— æ³•å‘ç‰Œï¼', 'error');
        return;
    }
    // ... ç»§ç»­æ‰§è¡Œ
}

drawCard(): Phaser.GameObjects.Container | null {
    if (!this.playerHand) {
        console.error('âŒ CardManager: playerHandæœªåˆå§‹åŒ–ï¼Œè¯·å…ˆè°ƒç”¨setHandGroups()');
        this.showMessage('å¡ç‰Œç³»ç»Ÿæœªå°±ç»ªï¼', 'error');
        return null;
    }
    // ... ç»§ç»­æ‰§è¡Œ
}
```

## ğŸ§ª éªŒè¯æ­¥éª¤

### 1. ä»£ç å±‚é¢éªŒè¯
- âœ… ç¡®è®¤ `setupManagerDependencies()` åœ¨ hand groups åˆ›å»ºåè°ƒç”¨
- âœ… ç¡®è®¤ CardManager æ–¹æ³•æœ‰é€‚å½“çš„ null æ£€æŸ¥
- âœ… ç¡®è®¤é”™è¯¯ä¿¡æ¯æ¸…æ™°æ˜“æ‡‚

### 2. è¿è¡Œæ—¶éªŒè¯
1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š`npm run dev`
2. æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦è¿˜æœ‰åˆå§‹åŒ–é”™è¯¯
3. éªŒè¯æ¸¸æˆæ˜¯å¦èƒ½æ­£å¸¸åŠ è½½
4. éªŒè¯åˆå§‹æ‰‹ç‰Œæ˜¯å¦èƒ½æ­£å¸¸å‘æ”¾

### 3. åŠŸèƒ½éªŒè¯
- âœ… ç©å®¶èƒ½å¦æ­£å¸¸æŠ½å¡
- âœ… å¯¹æ‰‹èƒ½å¦æ­£å¸¸æŠ½å¡  
- âœ… æ‰‹ç‰Œæ˜¾ç¤ºæ˜¯å¦æ­£å¸¸
- âœ… å¡ç‰Œç§»é™¤åŠŸèƒ½æ˜¯å¦æ­£å¸¸

## ğŸ“Š ä¿®å¤æˆæœ
- **é”™è¯¯æ¶ˆé™¤**: TypeError: Cannot read properties of undefined
- **ç¨³å®šæ€§æå‡**: æ·»åŠ äº†å…¨é¢çš„é˜²æŠ¤æ€§æ£€æŸ¥
- **è°ƒè¯•å‹å¥½**: æ¸…æ™°çš„é”™è¯¯æ—¥å¿—ä¾¿äºé—®é¢˜æ’æŸ¥
- **å‘åå…¼å®¹**: ä¸å½±å“ç°æœ‰åŠŸèƒ½

## ğŸ”„ æ€»ç»“
è¿™æ¬¡ä¿®å¤ä¸ä»…è§£å†³äº†å…·ä½“çš„åˆå§‹åŒ–é¡ºåºé—®é¢˜ï¼Œè¿˜é€šè¿‡æ·»åŠ é˜²æŠ¤æ€§æ£€æŸ¥æå‡äº†æ•´ä½“ä»£ç çš„å¥å£®æ€§ã€‚åœ¨æœªæ¥å¦‚æœå‡ºç°ç±»ä¼¼çš„åˆå§‹åŒ–é—®é¢˜ï¼Œç³»ç»Ÿä¼šç»™å‡ºæ¸…æ™°çš„é”™è¯¯æç¤ºè€Œä¸æ˜¯å´©æºƒã€‚ 